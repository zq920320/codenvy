<che-popup title="{{memberDialogController.title}}" on-close="memberDialogController.hide()">
  <div class="member-dialog-content">
    <ng-form flex layout="column" name="memberForm">
      <che-label-container che-label-name="Email" ng-show="!memberDialogController.member">
        <che-input-box che-form="memberForm"
                         che-name="email"
                         che-place-holder="Enter email"
                         ng-model="memberDialogController.email"
                         ng-model-options="{allowInvalid: true}"
                         ng-disabled="memberDialogController.isProcessing"
                         custom-validator="memberDialogController.isValidEmail($value)"
                         type="text"
                         aria-label="New member"
                         ng-keypress="memberForm.$valid && $event.which === 13 && memberDialogController.addMembers()"
                         required focusable>
            <div ng-message="required">A user email is required.</div>
            <div ng-message="customValidator">{{memberDialogController.emailError}}</div>
          </che-input-box>
      </che-label-container>
      <che-label-container che-label-name="Permissions" che-label-description="Allowed actions of team member">
        <div layout="column">
            <md-switch ng-repeat="roleInfo in memberDialogController.roles" ng-model="roleInfo.allowed"
                       ng-disabled="memberDialogController.isProcessing">
              <span>{{roleInfo.role.title}}</span>
              <span class="member-role-description">{{roleInfo.role.description}}</span>
            </md-switch>
          </div>
      </che-label-container>
    </ng-form>
    <div layout="row" layout-align="end center">
      <che-button-primary che-button-title="{{memberDialogController.buttonTitle}}"
                          ng-if="!memberDialogController.member"
                          ng-disabled="memberForm.$invalid || memberDialogController.isProcessing"
                          ng-click="memberDialogController.addMembers()"></che-button-primary>
      <che-button-primary che-button-title="{{memberDialogController.buttonTitle}}"
                          ng-disabled="memberDialogController.isProcessing"
                          ng-if="memberDialogController.member"
                          ng-click="memberDialogController.editMember()"></che-button-primary>
      <che-button-cancel-flat che-button-title="Cancel"
                              ng-click="memberDialogController.hide()"
                              tabindex="0"></che-button-cancel-flat>
    </div>
  </div>
</che-popup>
